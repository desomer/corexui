<xui-factory version="1.0">

	<xui-doc xid="page">
		<xui-prop var="title" editor="string">titre</xui-prop>
		<xui-prop var="titleApp" editor="string">titre de l'entete</xui-prop>
		<xui-prop var="colorApp" editor="string">couleur primaire</xui-prop>
		<xui-prop var="colorBg" editor="string">couleur fond de page</xui-prop>
		<xui-prop var="copyrightApp" editor="string">copyright de l'appli</xui-prop>

		<xui-prop id="name">Page</xui-prop>
		<xui-prop id="desc">La page</xui-prop>
	</xui-doc>  

	<xui-doc xid="v-container:vue-content-1">
        <xui-prop id="favorite">container</xui-prop>
        <xui-prop id="exclude"></xui-prop>
        <xui-prop id="include"></xui-prop>

		<xui-prop id="name">Content</xui-prop>
		<xui-prop id="desc">Contenu de la page</xui-prop>
	</xui-doc>

	<xui-doc xid="vue-toolbar-1">
		<xui-prop id="name">Header</xui-prop>
		<xui-prop id="desc">Entete</xui-prop>
	</xui-doc>

	<xui-doc xid="v-app-bar:vue-toolbar-1">
        <xui-prop id="favorite">action</xui-prop>
        <xui-prop id="exclude"></xui-prop>
        <xui-prop id="include"></xui-prop>

		<xui-prop id="name">Toolbar</xui-prop>
		<xui-prop id="desc">Toolbar de l'entete</xui-prop>
	</xui-doc>

	<xui-doc xid="vue-footer-1">
		<xui-prop id="name">Footer</xui-prop>
		<xui-prop id="desc">Pied de page</xui-prop>
	</xui-doc>

	<xui-doc xid="v-footer:vue-footer-1">
        <xui-prop id="favorite">action</xui-prop>
        <xui-prop id="exclude"></xui-prop>
        <xui-prop id="include"></xui-prop>

		<xui-prop id="name">Toolbar</xui-prop>
		<xui-prop id="desc">Toolbar du pied de page</xui-prop>
	</xui-doc>

	<!---------------------------------------------------------------------------------------->
	<!--  gestion page autonome -->
	<html xid="frame-vuetify-1" xui-mode="final;design;preview" style="height:100vh;" xui-slot-name="page" xui-doc-id="page" >
		<head xid="header-vuetify"></head>
		<body xid="body-vuetify" style="height:100vh"></body>
		<xui-script-data></xui-script-data>
		<script defer src="https://cdn.jsdelivr.net/npm/vue@2.6.x/dist/vue.min.js"></script>
		<script defer src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.js"></script>
		<xui-slot xid="inject-after-body"></xui-slot>
		<xui-init-vuetify></xui-init-vuetify>	
		<xui-init-designer></xui-init-designer>
	</html>

	<!--  gestion du designer -->
	<xui-slot xid="frame-vuetify-1" xui-mode="template" xui-slot-name="page" xui-doc-id="page">
		<body xid="body-vuetify" style="height:100vh"></body>
	</xui-slot>

	<!--------------------------------------------------------------------------------------->

	<xui-design xid="header-vuetify">
		<title>[[title]]</title>
		<viewport-no-zoom></viewport-no-zoom>
	
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mdi/font@4.x/css/materialdesignicons.min.css"/>
		<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons"/>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.min.css"/>
				
		<xui-slot xid="inject-other-header"></xui-slot>
	</xui-design>
	
	<meta xid="viewport-no-zoom" name="viewport" 
		content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
	</meta>
	
	<xui-design xid="maincontent" >
		<xui-slot xid="inject-design-ui" ></xui-slot>
		<vue-toolbar-1 xid="toolbar"></vue-toolbar-1>
		<vue-content-1></vue-content-1>
		<vue-footer-1 xid="footer"></vue-footer-1>
	</xui-design>
			
	<v-app-bar xid="vue-toolbar-1"  xui-slot-name="header bar" fixed app :dark="dark" :height="heightHeader" color="[[colorApp]]">
		<v-app-bar-nav-icon></v-app-bar-nav-icon>
		<v-toolbar-title>[[titleApp]]</v-toolbar-title>
		<v-spacer></v-spacer>
		<xui-slot xid="slot-action-header" xui-slot-name="action header"></xui-slot>
	</v-app-bar>
	
	<v-content xid="vue-content-1">
		<v-container fluid :fill-height="ContentfillPage" class="pa-0" style="align-items:start">
			<xui-slot xui-slot-full xid="main" xui-slot-name="page content"></xui-slot>
		</v-container>
	</v-content>
	
	<v-footer xid="vue-footer-1"  xui-slot-name="footer bar" inset app :height="heightFooter" :dark="dark" color="[[colorApp]]" style="padding: 0px 10px;">
	    <xui-slot xid="slot-action-footer" xui-slot-name="action footer"></xui-slot>
	    <v-spacer></v-spacer>
		<span>&amp;copy;&amp;nbsp;[[copyrightApp]]</span>
	</v-footer>

    <xui-design xid="body-vuetify">
		<template id = "xui-rootTemplate">
			<v-app xid="maincontent"  style="background:--colorBg--">
				<xui-trashcan></xui-trashcan>
			</v-app>
		</template>
		
		<div id="app"></div>

	</xui-design>

	<!----------------------------  TRASHCAN ---------------------------------->
	<div xid="xui-trashcan" xui-mode="template;design" 
		style="display:none; z-index: 100; background-color: white;position: absolute;border: 1px solid #0b00ff;top: 10vh;left: 10vw;height: 80vh;width: 80vw;">
		<xui-slot xid="xui-trashcan-slot"></xui-slot>
	</div>
	<xui-slot xid="xui-trashcan" xui-mode="final"></xui-slot>
	<!------------------------------------------------------------------------->

	<script xid="xui-script-data" >
	if (typeof $xui === 'undefined')
		$xui={};

	$xui.rootdata={ 
		dark:true, 
		heightHeader:32, 
		heightFooter:32, 
		ContentfillPage:true 
	};
	</script>

	<!--------------------------------------------------------------------------------------->
	<script type="module" xid="xui-init-vuetify">
		import "./app/vue2frame.js";
		$xui.loadApplicationJS();
	</script>

	<!--------------------------- PAS IMPLEMENTATION EN MODE FINAL ------------>
	<xui-slot xid="xui-init-designer" xui-mode="final"></xui-slot>

	<script xid="xui-init-designer" xui-mode="preview">
		document.addEventListener("keydown", function (event) {
			if (event.ctrlKey && event.keyCode == 81) {
				event.stopPropagation();
				event.preventDefault();
				var message = {
					action:"ctrlQ", 
				};
				window.parent.postMessage(message, "*");
			}
		});
	</script>

	<script xid="xui-init-designer" xui-mode="design">
		<xui-inject xui-path="app/cmpDesignDrop.js"></xui-inject>

		document.addEventListener('click', function(e) {    //dblclick
			let targetAction=e.target.closest("[data-xid]");

			let elemRect = targetAction.getBoundingClientRect();

			var message = {
				action:"select", 
				xid: targetAction.dataset.xid, 
				xid_slot: targetAction.dataset.xidSlot, 
				position: elemRect	
			};
			//console.debug("message", message);
			window.parent.postMessage(message, "*");
		});

		window.addEventListener('message',function(e) {
			var data = e.data;
			if (data.action=="changeTemplate")
			{
				var template = data.template;
				this.document.body.innerHTML=template;
				$xui.loadApplicationJS();
			}
		});
	</script>

</xui-factory>